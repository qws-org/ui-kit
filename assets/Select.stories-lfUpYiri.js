import{j as v}from"./jsx-runtime-D_zvdyIk.js";import{r as p,R as D}from"./index-D4lIrffr.js";import{$ as N,c as le,d as ie,a as U}from"./mergeProps-CASEEftK.js";import{$ as j}from"./filterDOMProps-CeZl_uWj.js";import{$ as re,a as se,b as de,c as ce,d as ue,e as fe}from"./useSelectableList-GvURuuA5.js";import{$ as me,a as pe,b as be,c as ve,d as ye,e as ge,f as he}from"./DOMLayoutDelegate-h8l8aDcK.js";import{m as $e,$ as L}from"./useUiKitComponents-t3zy5Zo0.js";import{$ as xe,a as Se,b as Ke}from"./useField-BMaf1bP8.js";import{$ as Pe,a as we}from"./useFormValidation-4fgG5orE.js";import{$ as ke}from"./VisuallyHidden-SZFRcEgu.js";import{B as De}from"./Button-DLqEWYsL.js";import{F as Fe}from"./Flex-DGp6_aFq.js";import{P as Me}from"./Popover-DjGcZcoV.js";import{$ as Ce}from"./useFocusWithin-Yfmk6-fR.js";import{$ as Ve,a as Oe}from"./platform-DzkwHEFt.js";import{$ as Be}from"./Overlay-Dtg55f1a.js";import{$ as _e}from"./useControlledState-YrJM5BK_.js";class z{*[Symbol.iterator](){yield*this.iterable}get size(){return this.keyMap.size}getKeys(){return this.keyMap.keys()}getKeyBefore(t){let l=this.keyMap.get(t);var a;return l&&(a=l.prevKey)!==null&&a!==void 0?a:null}getKeyAfter(t){let l=this.keyMap.get(t);var a;return l&&(a=l.nextKey)!==null&&a!==void 0?a:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(t){var l;return(l=this.keyMap.get(t))!==null&&l!==void 0?l:null}at(t){const l=[...this.getKeys()];return this.getItem(l[t])}getChildren(t){let l=this.keyMap.get(t);return(l==null?void 0:l.childNodes)||[]}constructor(t){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=t;let l=i=>{if(this.keyMap.set(i.key,i),i.childNodes&&i.type==="section")for(let s of i.childNodes)l(s)};for(let i of t)l(i);let a=null,r=0;for(let[i,s]of this.keyMap)a?(a.nextKey=i,s.prevKey=a.key):(this.firstKey=i,s.prevKey=void 0),s.type==="item"&&(s.index=r++),a=s,a.nextKey=void 0;var o;this.lastKey=(o=a==null?void 0:a.key)!==null&&o!==void 0?o:null}}function Re(e){let{filter:t,layoutDelegate:l}=e,a=me(e),r=p.useMemo(()=>e.disabledKeys?new Set(e.disabledKeys):new Set,[e.disabledKeys]),o=p.useCallback(n=>t?new z(t(n)):new z(n),[t]),i=p.useMemo(()=>({suppressTextValueWarning:e.suppressTextValueWarning}),[e.suppressTextValueWarning]),s=pe(e,o,i),c=p.useMemo(()=>new be(s,a,{layoutDelegate:l}),[s,a,l]);return Ne(s,c),{collection:s,disabledKeys:r,selectionManager:c}}function Ne(e,t){const l=p.useRef(null);p.useEffect(()=>{if(t.focusedKey!=null&&!e.getItem(t.focusedKey)&&l.current){const d=l.current.getItem(t.focusedKey),u=[...l.current.getKeys()].map(h=>{const b=l.current.getItem(h);return(b==null?void 0:b.type)==="item"?b:null}).filter(h=>h!==null),y=[...e.getKeys()].map(h=>{const b=e.getItem(h);return(b==null?void 0:b.type)==="item"?b:null}).filter(h=>h!==null);var a,r;const $=((a=u==null?void 0:u.length)!==null&&a!==void 0?a:0)-((r=y==null?void 0:y.length)!==null&&r!==void 0?r:0);var o,i,s;let g=Math.min($>1?Math.max(((o=d==null?void 0:d.index)!==null&&o!==void 0?o:0)-$+1,0):(i=d==null?void 0:d.index)!==null&&i!==void 0?i:0,((s=y==null?void 0:y.length)!==null&&s!==void 0?s:0)-1),x=null,P=!1;for(;g>=0;){if(!t.isDisabled(y[g].key)){x=y[g];break}if(g<y.length-1&&!P)g++;else{P=!0;var c,n;g>((c=d==null?void 0:d.index)!==null&&c!==void 0?c:0)&&(g=(n=d==null?void 0:d.index)!==null&&n!==void 0?n:0),g--}}t.setFocusedKey(x?x.key:null)}l.current=e},[e,t])}function We(e){var t;let[l,a]=_e(e.selectedKey,(t=e.defaultSelectedKey)!==null&&t!==void 0?t:null,e.onSelectionChange),r=p.useMemo(()=>l!=null?[l]:[],[l]),{collection:o,disabledKeys:i,selectionManager:s}=Re({...e,selectionMode:"single",disallowEmptySelection:!0,allowDuplicateSelectionEvents:!0,selectedKeys:r,onSelectionChange:n=>{if(n==="all")return;var d;let u=(d=n.values().next().value)!==null&&d!==void 0?d:null;u===l&&e.onSelectionChange&&e.onSelectionChange(u),a(u)}}),c=l!=null?o.getItem(l):null;return{collection:o,disabledKeys:i,selectionManager:s,selectedKey:l,setSelectedKey:a,selectedItem:c}}function qe(e){let t=Be(e),[l,a]=p.useState(null),r=We({...e,onSelectionChange:n=>{e.onSelectionChange!=null&&e.onSelectionChange(n),t.close(),o.commitValidation()}}),o=Pe({...e,value:r.selectedKey}),[i,s]=p.useState(!1),c=p.useMemo(()=>{var n;return r.collection.size===0||r.collection.size===1&&((n=r.collection.getItem(r.collection.getFirstKey()))===null||n===void 0?void 0:n.type)==="loader"},[r.collection]);return{...o,...r,...t,focusStrategy:l,open(n=null){c||(a(n),t.open())},toggle(n=null){c||(a(n),t.toggle())},isFocused:i,setFocused:s}}const Ae=e=>v.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:8,fill:"none",...e,children:v.jsx("path",{fill:"#fff",fillOpacity:.5,fillRule:"evenodd",d:"M.793 1.043a1 1 0 0 1 1.414 0L6 4.836l3.793-3.793a1 1 0 0 1 1.414 1.414l-4.5 4.5a1 1 0 0 1-1.414 0l-4.5-4.5a1 1 0 0 1 0-1.414",clipRule:"evenodd"})});try{ArrowDown.displayName="ArrowDown",ArrowDown.__docgenInfo={description:"",displayName:"ArrowDown",props:{}}}catch{}const ae=new WeakMap;function Ee(e,t,l){let{keyboardDelegate:a,isDisabled:r,isRequired:o,name:i,validationBehavior:s="aria"}=e,c=ve({usage:"search",sensitivity:"base"}),n=p.useMemo(()=>a||new re(t.collection,t.disabledKeys,l,c),[a,t.collection,t.disabledKeys,c,l]),{menuTriggerProps:d,menuProps:u}=se({isDisabled:r,type:"listbox"},t,l),y=m=>{switch(m.key){case"ArrowLeft":{var C,V;m.preventDefault();let K=t.selectedKey!=null?(C=n.getKeyAbove)===null||C===void 0?void 0:C.call(n,t.selectedKey):(V=n.getFirstKey)===null||V===void 0?void 0:V.call(n);K&&t.setSelectedKey(K);break}case"ArrowRight":{var w,O;m.preventDefault();let K=t.selectedKey!=null?(w=n.getKeyBelow)===null||w===void 0?void 0:w.call(n,t.selectedKey):(O=n.getFirstKey)===null||O===void 0?void 0:O.call(n);K&&t.setSelectedKey(K);break}}},{typeSelectProps:$}=ye({keyboardDelegate:n,selectionManager:t.selectionManager,onTypeSelect(m){t.setSelectedKey(m)}}),{isInvalid:g,validationErrors:x,validationDetails:P}=t.displayValidation,{labelProps:h,fieldProps:b,descriptionProps:W,errorMessageProps:q}=xe({...e,labelElementType:"span",isInvalid:g,errorMessage:e.errorMessage||x});$.onKeyDown=$.onKeyDownCapture,delete $.onKeyDownCapture;let S=j(e,{labelable:!0}),f=N($,d,b),M=le();return ae.set(t,{isDisabled:r,isRequired:o,name:i,validationBehavior:s}),{labelProps:{...h,onClick:()=>{if(!e.isDisabled){var m;(m=l.current)===null||m===void 0||m.focus(),$e("keyboard")}}},triggerProps:N(S,{...f,isDisabled:r,onKeyDown:ie(f.onKeyDown,y,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[M,f["aria-labelledby"],f["aria-label"]&&!f["aria-labelledby"]?f.id:null].filter(Boolean).join(" "),onFocus(m){t.isFocused||(e.onFocus&&e.onFocus(m),e.onFocusChange&&e.onFocusChange(!0),t.setFocused(!0))},onBlur(m){t.isOpen||(e.onBlur&&e.onBlur(m),e.onFocusChange&&e.onFocusChange(!1),t.setFocused(!1))}}),valueProps:{id:M},menuProps:{...u,autoFocus:t.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:m=>{m.currentTarget.contains(m.relatedTarget)||(e.onBlur&&e.onBlur(m),e.onFocusChange&&e.onFocusChange(!1),t.setFocused(!1))},"aria-labelledby":[b["aria-labelledby"],f["aria-label"]&&!b["aria-labelledby"]?f.id:null].filter(Boolean).join(" ")},descriptionProps:W,errorMessageProps:q,isInvalid:g,validationErrors:x,validationDetails:P}}function je(e,t,l){let a=ae.get(t)||{},{autoComplete:r,name:o=a.name,isDisabled:i=a.isDisabled}=e,{validationBehavior:s,isRequired:c}=a,{visuallyHiddenProps:n}=ke();Se(e.selectRef,t.selectedKey,t.setSelectedKey),we({validationBehavior:s,focus:()=>{var u;return(u=l.current)===null||u===void 0?void 0:u.focus()}},t,e.selectRef);var d;return{containerProps:{...n,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:r,disabled:i,required:s==="native"&&c,name:o,value:(d=t.selectedKey)!==null&&d!==void 0?d:void 0,onChange:u=>t.setSelectedKey(u.target.value)}}}function Ie(e){let{state:t,triggerRef:l,label:a,name:r,isDisabled:o}=e,i=p.useRef(null),{containerProps:s,selectProps:c}=je({...e,selectRef:i},t,l);var n;return t.collection.size<=300?D.createElement("div",{...s,"data-testid":"hidden-select-container"},D.createElement("label",null,a,D.createElement("select",{...c,ref:i},D.createElement("option",null),[...t.collection.getKeys()].map(d=>{let u=t.collection.getItem(d);if(u&&u.type==="item")return D.createElement("option",{key:u.key,value:u.key},u.textValue)})))):r?D.createElement("input",{type:"hidden",autoComplete:c.autoComplete,name:r,disabled:o,value:(n=t.selectedKey)!==null&&n!==void 0?n:""}):null}const I=new WeakMap;function Te(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function Ue(e,t){let l=I.get(e);if(!l)throw new Error("Unknown list");return`${l.id}-option-${Te(t)}`}function Le(e,t,l){let a=j(e,{labelable:!0}),r=e.selectionBehavior||"toggle",o=e.linkBehavior||(r==="replace"?"action":"override");r==="toggle"&&o==="action"&&(o="override");let{listProps:i}=de({...e,ref:l,selectionManager:t.selectionManager,collection:t.collection,disabledKeys:t.disabledKeys,linkBehavior:o}),{focusWithinProps:s}=Ce({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),c=le(e.id);I.set(t,{id:c,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:o});let{labelProps:n,fieldProps:d}=Ke({...e,id:c,labelElementType:"span"});return{labelProps:n,listBoxProps:N(a,s,t.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...N(d,i)})}}function ze(e,t,l){var a,r;let{key:o}=e,i=I.get(t);var s;let c=(s=e.isDisabled)!==null&&s!==void 0?s:t.selectionManager.isDisabled(o);var n;let d=(n=e.isSelected)!==null&&n!==void 0?n:t.selectionManager.isSelected(o);var u;let y=(u=e.shouldSelectOnPressUp)!==null&&u!==void 0?u:i==null?void 0:i.shouldSelectOnPressUp;var $;let g=($=e.shouldFocusOnHover)!==null&&$!==void 0?$:i==null?void 0:i.shouldFocusOnHover;var x;let P=(x=e.shouldUseVirtualFocus)!==null&&x!==void 0?x:i==null?void 0:i.shouldUseVirtualFocus;var h;let b=(h=e.isVirtualized)!==null&&h!==void 0?h:i==null?void 0:i.isVirtualized,W=U(),q=U(),S={role:"option","aria-disabled":c||void 0,"aria-selected":t.selectionManager.selectionMode!=="none"?d:void 0};Ve()&&Oe()||(S["aria-label"]=e["aria-label"],S["aria-labelledby"]=W,S["aria-describedby"]=q);let f=t.collection.getItem(o);if(b){let k=Number(f==null?void 0:f.index);S["aria-posinset"]=Number.isNaN(k)?void 0:k+1,S["aria-setsize"]=ce(t.collection)}let M=i!=null&&i.onAction?()=>{var k;return i==null||(k=i.onAction)===null||k===void 0?void 0:k.call(i,o)}:void 0,m=Ue(t,o),{itemProps:C,isPressed:V,isFocused:w,hasAction:O,allowsSelection:K}=ge({selectionManager:t.selectionManager,key:o,ref:l,shouldSelectOnPressUp:y,allowsDifferentPressOrigin:y&&g,isVirtualized:b,shouldUseVirtualFocus:P,isDisabled:c,onAction:M||!(f==null||(a=f.props)===null||a===void 0)&&a.onAction?ie(f==null||(r=f.props)===null||r===void 0?void 0:r.onAction,M):void 0,linkBehavior:i==null?void 0:i.linkBehavior,id:m}),{hoverProps:ne}=ue({isDisabled:c||!g,onHoverStart(){L()||(t.selectionManager.setFocused(!0),t.selectionManager.setFocusedKey(o))}}),T=j(f==null?void 0:f.props);delete T.id;let oe=he(f==null?void 0:f.props);return{optionProps:{...S,...N(T,C,ne,oe),id:m},labelProps:{id:W},descriptionProps:{id:q},isFocused:w,isFocusVisible:w&&t.selectionManager.isFocused&&L(),isSelected:d,isDisabled:c,isPressed:V,allowsSelection:K,hasAction:O}}const A=function({item:e,state:t}){const l=p.useRef(null),{optionProps:a,isDisabled:r}=ze({key:e.key},t,l);return v.jsx("li",{...a,ref:l,style:{padding:10},className:`cursor-pointer  outline-none  ${r?"bg-[var(--colors-surface-neutral-subtle)]":"bg-[var(--colors-background-transparent)]"}`,children:e.rendered})};try{A.displayName="SelectOption",A.__docgenInfo={description:"",displayName:"SelectOption",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Node<T>"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"ListState<T>"}}}}}catch{}const E=p.forwardRef(function(e,t){const l=p.useRef(null),a=t??l,{state:r,minWidth:o="auto",maxWidth:i="auto"}=e,{listBoxProps:s}=Le(e,r,a);return v.jsx("ul",{...s,ref:a,style:{width:"100%",padding:0,margin:0,minWidth:o,maxWidth:i},className:`bg-[var(--colors-background-transparent)] rounded overflow-hidden ${e.className}`,children:[...r.collection].map(c=>v.jsx(A,{item:c,state:r},c.key))})});try{E.displayName="SelectOptionList",E.__docgenInfo={description:"",displayName:"SelectOptionList",props:{state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"ListState<unknown>"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"number"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number"}}}}}catch{}const F=function(e){let t=e.items;const l=typeof t[0]=="string"||typeof t[0]=="number";l&&(t=t.map(n=>({id:n})));const r={...e,items:t,onSelectionChange:n=>{const d=JSON.parse(String(n));e.onChange(d)},children:n=>{var u;const d=l?n.id:((u=e.getOptionLabel)==null?void 0:u.call(e,n))??String(n.name);return v.jsx(fe,{children:String(d)},JSON.stringify(n))}},o=qe(r),i=p.useRef(null),{triggerProps:s,menuProps:c}=Ee(r,o,i);return v.jsxs("div",{children:[v.jsx(Ie,{isDisabled:e.disabled,state:o,triggerRef:i,label:e.emptyText,name:e.name}),v.jsx(De,{className:` ${e.className}`,size:"small",variant:"secondary",...s,ref:i,p:{px:12,py:10},minWidth:e.minWidth,maxWidth:e.maxWidth,children:v.jsxs(Fe,{width:"100%",gap:10,align:"center",justify:"space-between",children:[o.selectedItem?o.selectedItem.rendered:e.emptyText??"Select an option",v.jsx(Ae,{width:"12",height:"8",viewBox:"0 0 12 8"})]})}),o.isOpen&&v.jsx(Me,{state:o,triggerRef:i,placement:"bottom start",children:v.jsx(E,{minWidth:162,...c,state:o})})]})};try{F.displayName="Select",F.__docgenInfo={description:"",displayName:"Select",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"Elem"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: T) => void"}},getOptionLabel:{defaultValue:null,description:"",name:"getOptionLabel",required:!1,type:{name:"((value: T) => ReactNode)"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"T[]"}},emptyText:{defaultValue:null,description:"",name:"emptyText",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string | number"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"string | number"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"string | number"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"string | number"}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:"string | number"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"string | number"}},p:{defaultValue:null,description:"",name:"p",required:!1,type:{name:"any"}},m:{defaultValue:null,description:"",name:"m",required:!1,type:{name:"any"}}}}}catch{}const He={title:"UI-Kit components/Select",component:F,argTypes:{emptyText:{control:"text",description:"Текст, который отобразится в случае если не выбран ни 1 элемент"},getOptionLabel:{control:"object",description:"Функция которая позволяет выводить кастомные поля для описания опции, либо же кастомизировать реализацию самой опции"},items:{description:"Список элементов которые отображаются в выпадающем списке"}}},B={render:()=>{const e=[{id:1,name:"Aerospace"},{id:2,name:"Mechanical"},{id:3,name:"Civil"},{id:4,name:"Biomedical"},{id:5,name:"Nuclear"},{id:6,name:"Industrial"},{id:7,name:"Chemical"},{id:8,name:"Agricultural"},{id:9,name:"Electrical"}],[t,l]=p.useState();return v.jsx(F,{value:t,onChange:l,items:e,"aria-label":"select"})}},_={render:()=>{const e=[{id:1,label:"Aerospace"},{id:2,label:"Mechanical"},{id:3,label:"Civil"},{id:4,label:"Biomedical"}],[t,l]=p.useState(e[0]);return v.jsx(F,{value:t,onChange:l,items:e,"aria-label":"select",getOptionLabel:a=>a.label})}},R={render:()=>{const e=["1","2","3"],[t,l]=p.useState(e[0]);return v.jsx(F,{value:t,onChange:l,items:e,"aria-label":"select",getOptionLabel:a=>a})}};var H,J,G;B.parameters={...B.parameters,docs:{...(H=B.parameters)==null?void 0:H.docs,source:{originalSource:`{
  render: () => {
    const options: Array<Option> = [{
      id: 1,
      name: "Aerospace"
    }, {
      id: 2,
      name: "Mechanical"
    }, {
      id: 3,
      name: "Civil"
    }, {
      id: 4,
      name: "Biomedical"
    }, {
      id: 5,
      name: "Nuclear"
    }, {
      id: 6,
      name: "Industrial"
    }, {
      id: 7,
      name: "Chemical"
    }, {
      id: 8,
      name: "Agricultural"
    }, {
      id: 9,
      name: "Electrical"
    }];
    const [state, setState] = useState<Option>();
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} />;
  }
}`,...(G=(J=B.parameters)==null?void 0:J.docs)==null?void 0:G.source}}};var Q,X,Y;_.parameters={..._.parameters,docs:{...(Q=_.parameters)==null?void 0:Q.docs,source:{originalSource:`{
  render: () => {
    const options: Array<Option2> = [{
      id: 1,
      label: "Aerospace"
    }, {
      id: 2,
      label: "Mechanical"
    }, {
      id: 3,
      label: "Civil"
    }, {
      id: 4,
      label: "Biomedical"
    }];
    const [state, setState] = useState<Option2>(options[0]);
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} getOptionLabel={v => v.label} />;
  }
}`,...(Y=(X=_.parameters)==null?void 0:X.docs)==null?void 0:Y.source}}};var Z,ee,te;R.parameters={...R.parameters,docs:{...(Z=R.parameters)==null?void 0:Z.docs,source:{originalSource:`{
  render: () => {
    const options: Array<string> = ["1", "2", "3"];
    const [state, setState] = useState<string>(options[0]);
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} getOptionLabel={v => v} />;
  }
}`,...(te=(ee=R.parameters)==null?void 0:ee.docs)==null?void 0:te.source}}};const Je=["Default","WithCustomStructure","WithElementaryList"],ft=Object.freeze(Object.defineProperty({__proto__:null,Default:B,WithCustomStructure:_,WithElementaryList:R,__namedExportsOrder:Je,default:He},Symbol.toStringTag,{value:"Module"}));export{B as D,ft as s};

import{j as g}from"./jsx-runtime-D_zvdyIk.js";import{r as c,R as F}from"./index-D4lIrffr.js";import{B as me}from"./Button-By9hWAFk.js";import{F as pe}from"./Flex-C7UOgSUL.js";import{P as be}from"./Popover-W5vvqBVY.js";import{B as ve}from"./Box-6kaav-hc.js";import{T as ge}from"./Typography-88DkPW9h.js";import{l as se,k as N,p as Q,A as ye,B as $e,z as de,$ as Y,o as he}from"./useFocus-CQXXRA8U.js";import{b as L,e as Se}from"./useFocusable-BOYJSphf.js";import{$ as xe,a as Ve,b as Pe,c as De,d as Ce}from"./useMenuTrigger-DkXfiP5q.js";import{d as we,f as Ee}from"./useSelectableItem-B_JS6ELj.js";import{$ as Fe}from"./useFocusWithin-CIsqjyvK.js";import{a as Oe,$ as _e}from"./useField-BilHrmha.js";import{a as Be}from"./Overlay-Bua0Yu3e.js";import{$ as Me}from"./useSingleSelectListState-Cgw24Jcx.js";import{$ as ke}from"./getChildNodes-Bq8KL8Fw.js";import{$ as Ae,a as Re}from"./useFormValidation-D42ZibEu.js";import{$ as Ie}from"./VisuallyHidden-Db3mqzsr.js";import{$ as qe}from"./Item-Uk9RLypc.js";const ce={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},ue={...ce,customError:!0,valid:!1},R={isInvalid:!1,validationDetails:ce,validationErrors:[]},Ke=c.createContext({}),G="__formValidationState"+Date.now();function Ne(e){if(e[G]){let{realtimeValidation:t,displayValidation:a,updateValidation:n,resetValidation:o,commitValidation:l}=e[G];return{realtimeValidation:t,displayValidation:a,updateValidation:n,resetValidation:o,commitValidation:l}}return je(e)}function je(e){let{isInvalid:t,validationState:a,name:n,value:o,builtinValidation:l,validate:i,validationBehavior:u="aria"}=e;a&&(t||(t=a==="invalid"));let d=t!==void 0?{isInvalid:t,validationErrors:[],validationDetails:ue}:null,s=c.useMemo(()=>{if(!i||o==null)return null;let m=Te(i,o);return X(m)},[i,o]);l!=null&&l.validationDetails.valid&&(l=void 0);let r=c.useContext(Ke),p=c.useMemo(()=>n?Array.isArray(n)?n.flatMap(m=>T(r[m])):T(r[n]):[],[r,n]),[y,f]=c.useState(r),[h,S]=c.useState(!1);r!==y&&(f(r),S(!1));let D=c.useMemo(()=>X(h?[]:p),[h,p]),C=c.useRef(R),[w,x]=c.useState(R),P=c.useRef(R),V=()=>{if(!v)return;$(!1);let m=s||l||C.current;j(m,P.current)||(P.current=m,x(m))},[v,$]=c.useState(!1);return c.useEffect(V),{realtimeValidation:d||D||s||l||R,displayValidation:u==="native"?d||D||w:d||D||s||l||w,updateValidation(m){u==="aria"&&!j(w,m)?x(m):C.current=m},resetValidation(){let m=R;j(m,P.current)||(P.current=m,x(m)),u==="native"&&$(!1),S(!0)},commitValidation(){u==="native"&&$(!0),S(!0)}}}function T(e){return e?Array.isArray(e)?e:[e]:[]}function Te(e,t){if(typeof e=="function"){let a=e(t);if(a&&typeof a!="boolean")return T(a)}return[]}function X(e){return e.length?{isInvalid:!0,validationErrors:e,validationDetails:ue}:null}function j(e,t){return e===t?!0:!!e&&!!t&&e.isInvalid===t.isInvalid&&e.validationErrors.length===t.validationErrors.length&&e.validationErrors.every((a,n)=>a===t.validationErrors[n])&&Object.entries(e.validationDetails).every(([a,n])=>t.validationDetails[a]===n)}function We(e){let t=Be(e),[a,n]=c.useState(null),o=Me({...e,onSelectionChange:s=>{e.onSelectionChange!=null&&e.onSelectionChange(s),t.close(),l.commitValidation()}}),l=Ne({...e,value:o.selectedKey}),[i,u]=c.useState(!1),d=c.useMemo(()=>{var s;return o.collection.size===0||o.collection.size===1&&((s=o.collection.getItem(o.collection.getFirstKey()))===null||s===void 0?void 0:s.type)==="loader"},[o.collection]);return{...l,...o,...t,focusStrategy:a,open(s=null){d||(n(s),t.open())},toggle(s=null){d||(n(s),t.toggle())},isFocused:i,setFocused:u}}const z=new WeakMap;function Ue(e){return typeof e=="string"?e.replace(/\s*/g,""):""+e}function Le(e,t){let a=z.get(e);if(!a)throw new Error("Unknown list");return`${a.id}-option-${Ue(t)}`}function ze(e,t,a){let n=L(e,{labelable:!0}),o=e.selectionBehavior||"toggle",l=e.linkBehavior||(o==="replace"?"action":"override");o==="toggle"&&l==="action"&&(l="override");let{listProps:i}=xe({...e,ref:a,selectionManager:t.selectionManager,collection:t.collection,disabledKeys:t.disabledKeys,linkBehavior:l}),{focusWithinProps:u}=Fe({onFocusWithin:e.onFocus,onBlurWithin:e.onBlur,onFocusWithinChange:e.onFocusChange}),d=se(e.id);z.set(t,{id:d,shouldUseVirtualFocus:e.shouldUseVirtualFocus,shouldSelectOnPressUp:e.shouldSelectOnPressUp,shouldFocusOnHover:e.shouldFocusOnHover,isVirtualized:e.isVirtualized,onAction:e.onAction,linkBehavior:l});let{labelProps:s,fieldProps:r}=Oe({...e,id:d,labelElementType:"span"});return{labelProps:s,listBoxProps:N(n,u,t.selectionManager.selectionMode==="multiple"?{"aria-multiselectable":"true"}:{},{role:"listbox",...N(r,i)})}}function He(e,t,a){var n,o;let{key:l}=e,i=z.get(t);var u;let d=(u=e.isDisabled)!==null&&u!==void 0?u:t.selectionManager.isDisabled(l);var s;let r=(s=e.isSelected)!==null&&s!==void 0?s:t.selectionManager.isSelected(l);var p;let y=(p=e.shouldSelectOnPressUp)!==null&&p!==void 0?p:i==null?void 0:i.shouldSelectOnPressUp;var f;let h=(f=e.shouldFocusOnHover)!==null&&f!==void 0?f:i==null?void 0:i.shouldFocusOnHover;var S;let D=(S=e.shouldUseVirtualFocus)!==null&&S!==void 0?S:i==null?void 0:i.shouldUseVirtualFocus;var C;let w=(C=e.isVirtualized)!==null&&C!==void 0?C:i==null?void 0:i.isVirtualized,x=Q(),P=Q(),V={role:"option","aria-disabled":d||void 0,"aria-selected":t.selectionManager.selectionMode!=="none"?r:void 0};ye()&&$e()||(V["aria-label"]=e["aria-label"],V["aria-labelledby"]=x,V["aria-describedby"]=P);let v=t.collection.getItem(l);if(w){let B=Number(v==null?void 0:v.index);V["aria-posinset"]=Number.isNaN(B)?void 0:B+1,V["aria-setsize"]=Ve(t.collection)}let $=i!=null&&i.onAction?()=>{var B;return i==null||(B=i.onAction)===null||B===void 0?void 0:B.call(i,l)}:void 0,O=Le(t,l),{itemProps:b,isPressed:m,isFocused:_,hasAction:k,allowsSelection:A}=we({selectionManager:t.selectionManager,key:l,ref:a,shouldSelectOnPressUp:y,allowsDifferentPressOrigin:y&&h,isVirtualized:w,shouldUseVirtualFocus:D,isDisabled:d,onAction:$||!(v==null||(n=v.props)===null||n===void 0)&&n.onAction?de(v==null||(o=v.props)===null||o===void 0?void 0:o.onAction,$):void 0,linkBehavior:i==null?void 0:i.linkBehavior,id:O}),{hoverProps:E}=Pe({isDisabled:d||!h,onHoverStart(){Y()||(t.selectionManager.setFocused(!0),t.selectionManager.setFocusedKey(l))}}),J=L(v==null?void 0:v.props);delete J.id;let fe=Se(v==null?void 0:v.props);return{optionProps:{...V,...N(J,b,E,fe),id:O},labelProps:{id:x},descriptionProps:{id:P},isFocused:_,isFocusVisible:_&&t.selectionManager.isFocused&&Y(),isSelected:r,isDisabled:d,isPressed:m,allowsSelection:A,hasAction:k}}const H=new WeakMap;function Je(e,t,a){let{keyboardDelegate:n,isDisabled:o,isRequired:l,name:i,form:u,validationBehavior:d="aria"}=e,s=ke({usage:"search",sensitivity:"base"}),r=c.useMemo(()=>n||new De(t.collection,t.disabledKeys,a,s),[n,t.collection,t.disabledKeys,s,a]),{menuTriggerProps:p,menuProps:y}=Ce({isDisabled:o,type:"listbox"},t,a),f=b=>{switch(b.key){case"ArrowLeft":{var m,_;b.preventDefault();let E=t.selectedKey!=null?(m=r.getKeyAbove)===null||m===void 0?void 0:m.call(r,t.selectedKey):(_=r.getFirstKey)===null||_===void 0?void 0:_.call(r);E&&t.setSelectedKey(E);break}case"ArrowRight":{var k,A;b.preventDefault();let E=t.selectedKey!=null?(k=r.getKeyBelow)===null||k===void 0?void 0:k.call(r,t.selectedKey):(A=r.getFirstKey)===null||A===void 0?void 0:A.call(r);E&&t.setSelectedKey(E);break}}},{typeSelectProps:h}=Ee({keyboardDelegate:r,selectionManager:t.selectionManager,onTypeSelect(b){t.setSelectedKey(b)}}),{isInvalid:S,validationErrors:D,validationDetails:C}=t.displayValidation,{labelProps:w,fieldProps:x,descriptionProps:P,errorMessageProps:V}=_e({...e,labelElementType:"span",isInvalid:S,errorMessage:e.errorMessage||D});h.onKeyDown=h.onKeyDownCapture,delete h.onKeyDownCapture;let v=L(e,{labelable:!0}),$=N(h,p,x),O=se();return H.set(t,{isDisabled:o,isRequired:l,name:i,form:u,validationBehavior:d}),{labelProps:{...w,onClick:()=>{if(!e.isDisabled){var b;(b=a.current)===null||b===void 0||b.focus(),he("keyboard")}}},triggerProps:N(v,{...$,isDisabled:o,onKeyDown:de($.onKeyDown,f,e.onKeyDown),onKeyUp:e.onKeyUp,"aria-labelledby":[O,$["aria-labelledby"],$["aria-label"]&&!$["aria-labelledby"]?$.id:null].filter(Boolean).join(" "),onFocus(b){t.isFocused||(e.onFocus&&e.onFocus(b),e.onFocusChange&&e.onFocusChange(!0),t.setFocused(!0))},onBlur(b){t.isOpen||(e.onBlur&&e.onBlur(b),e.onFocusChange&&e.onFocusChange(!1),t.setFocused(!1))}}),valueProps:{id:O},menuProps:{...y,autoFocus:t.focusStrategy||!0,shouldSelectOnPressUp:!0,shouldFocusOnHover:!0,disallowEmptySelection:!0,linkBehavior:"selection",onBlur:b=>{b.currentTarget.contains(b.relatedTarget)||(e.onBlur&&e.onBlur(b),e.onFocusChange&&e.onFocusChange(!1),t.setFocused(!1))},"aria-labelledby":[x["aria-labelledby"],$["aria-label"]&&!x["aria-labelledby"]?$.id:null].filter(Boolean).join(" ")},descriptionProps:P,errorMessageProps:V,isInvalid:S,validationErrors:D,validationDetails:C,hiddenSelectProps:{isDisabled:o,name:i,label:e.label,state:t,triggerRef:a,form:u}}}function Qe(e,t,a){let n=H.get(t)||{},{autoComplete:o,name:l=n.name,form:i=n.form,isDisabled:u=n.isDisabled}=e,{validationBehavior:d,isRequired:s}=n,{visuallyHiddenProps:r}=Ie({style:{position:"fixed",top:0,left:0}});Ae(e.selectRef,t.defaultSelectedKey,t.setSelectedKey),Re({validationBehavior:d,focus:()=>{var f;return(f=a.current)===null||f===void 0?void 0:f.focus()}},t,e.selectRef);let p=c.useCallback(f=>t.setSelectedKey(f.currentTarget.value),[t.setSelectedKey]);var y;return{containerProps:{...r,"aria-hidden":!0,"data-react-aria-prevent-focus":!0,"data-a11y-ignore":"aria-hidden-focus"},inputProps:{style:{display:"none"}},selectProps:{tabIndex:-1,autoComplete:o,disabled:u,required:d==="native"&&s,name:l,form:i,value:(y=t.selectedKey)!==null&&y!==void 0?y:"",onChange:p,onInput:p}}}function Ye(e){let{state:t,triggerRef:a,label:n,name:o,form:l,isDisabled:i}=e,u=c.useRef(null),d=c.useRef(null),{containerProps:s,selectProps:r}=Qe({...e,selectRef:t.collection.size<=300?u:d},t,a);if(t.collection.size<=300)return F.createElement("div",{...s,"data-testid":"hidden-select-container"},F.createElement("label",null,n,F.createElement("select",{...r,ref:u},F.createElement("option",null),[...t.collection.getKeys()].map(y=>{let f=t.collection.getItem(y);if(f&&f.type==="item")return F.createElement("option",{key:f.key,value:f.key},f.textValue)}))));if(o){let y=H.get(t)||{},{validationBehavior:f}=y;var p;let h={type:"hidden",autoComplete:r.autoComplete,name:o,form:l,disabled:i,value:(p=t.selectedKey)!==null&&p!==void 0?p:""};return f==="native"?F.createElement("input",{...h,ref:d,style:{display:"none"},type:"text",required:r.required,onChange:()=>{}}):F.createElement("input",{...h,ref:d})}return null}const Ge=e=>g.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:12,height:8,fill:"none",...e,children:g.jsx("path",{fill:"#fff",fillOpacity:.5,fillRule:"evenodd",d:"M.793 1.043a1 1 0 0 1 1.414 0L6 4.836l3.793-3.793a1 1 0 0 1 1.414 1.414l-4.5 4.5a1 1 0 0 1-1.414 0l-4.5-4.5a1 1 0 0 1 0-1.414",clipRule:"evenodd"})});try{ArrowDown.displayName="ArrowDown",ArrowDown.__docgenInfo={description:"",displayName:"ArrowDown",props:{}}}catch{}const W=function({item:e,state:t}){const a=c.useRef(null),{optionProps:n,isDisabled:o}=He({key:e.key},t,a);return g.jsx(ve,{as:"li",ref:a,bg:o?"surface-neutral-subtle":"background-transparent",className:"cursor-pointer outline-none",...n,style:{padding:10},onClick:()=>t.selectionManager.toggleSelection(e.key),children:g.jsx(ge,{color:"text-primary-default",children:e.rendered})})};try{W.displayName="SelectOption",W.__docgenInfo={description:"",displayName:"SelectOption",props:{item:{defaultValue:null,description:"",name:"item",required:!0,type:{name:"Node<T>"}},state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"ListState<T>"}}}}}catch{}const U=c.forwardRef(function(e,t){const a=c.useRef(null),n=t!=null?t:a,{state:o,minWidth:l="auto",maxWidth:i="auto"}=e,{listBoxProps:u}=ze(e,o,n);return g.jsx("ul",{...u,ref:n,style:{width:"100%",padding:0,margin:0,minWidth:l,maxWidth:i},className:`bg-[var(--colors-background-transparent)] rounded overflow-hidden ${e.className}`,children:[...o.collection].map(d=>g.jsx(W,{item:d,state:o},d.key))})});try{U.displayName="SelectOptionList",U.__docgenInfo={description:"",displayName:"SelectOptionList",props:{state:{defaultValue:null,description:"",name:"state",required:!0,type:{name:"ListState<unknown>"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"number"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"number"}}}}}catch{}const M=function(e){var s;let t=e.items;const a=typeof t[0]=="string"||typeof t[0]=="number";a&&(t=t.map(r=>({id:r})));const o={...e,items:t,onSelectionChange:r=>{const p=JSON.parse(String(r));e.onChange(a?p.id:p)},children:r=>{var y,f;const p=a?r.id:(f=(y=e.getOptionLabel)==null?void 0:y.call(e,r))!=null?f:String(r.name);return g.jsx(qe,{children:String(p)},JSON.stringify(r))}},l=We(o),i=c.useRef(null),{triggerProps:u,menuProps:d}=Je(o,l,i);return g.jsxs(g.Fragment,{children:[g.jsx(Ye,{isDisabled:e.disabled,state:l,triggerRef:i,label:e.emptyText,name:e.name}),g.jsx(me,{className:`${e.className}`,size:"small",variant:"secondary",...u,ref:i,p:{px:12,py:10},minWidth:e.minWidth,maxWidth:e.maxWidth,onPress:()=>{l.isOpen||l.toggle()},children:g.jsxs(pe,{width:"100%",gap:10,align:"center",justify:"space-between",children:[l.selectedItem?l.selectedItem.rendered:(s=e.emptyText)!=null?s:"Select an option",g.jsx(Ge,{width:"12",height:"8",viewBox:"0 0 12 8"})]})}),l.isOpen&&g.jsx(be,{state:l,triggerRef:i,placement:"bottom start",children:g.jsx(U,{minWidth:162,...d,state:l})})]})};try{M.displayName="Select",M.__docgenInfo={description:"",displayName:"Select",props:{value:{defaultValue:null,description:"",name:"value",required:!1,type:{name:"Elem"}},onChange:{defaultValue:null,description:"",name:"onChange",required:!0,type:{name:"(value: T) => void"}},getOptionLabel:{defaultValue:null,description:"",name:"getOptionLabel",required:!1,type:{name:"((value: T) => ReactNode)"}},items:{defaultValue:null,description:"",name:"items",required:!0,type:{name:"T[]"}},emptyText:{defaultValue:null,description:"",name:"emptyText",required:!1,type:{name:"string"}},name:{defaultValue:null,description:"",name:"name",required:!1,type:{name:"string"}},disabled:{defaultValue:null,description:"",name:"disabled",required:!1,type:{name:"boolean"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},width:{defaultValue:null,description:"",name:"width",required:!1,type:{name:"string | number"}},minWidth:{defaultValue:null,description:"",name:"minWidth",required:!1,type:{name:"string | number"}},maxWidth:{defaultValue:null,description:"",name:"maxWidth",required:!1,type:{name:"string | number"}},height:{defaultValue:null,description:"",name:"height",required:!1,type:{name:"string | number"}},minHeight:{defaultValue:null,description:"",name:"minHeight",required:!1,type:{name:"string | number"}},maxHeight:{defaultValue:null,description:"",name:"maxHeight",required:!1,type:{name:"string | number"}},p:{defaultValue:null,description:"",name:"p",required:!1,type:{name:"any"}},m:{defaultValue:null,description:"",name:"m",required:!1,type:{name:"any"}}}}}catch{}const Xe={title:"UI-Kit components/Select",component:M,argTypes:{emptyText:{control:"text",description:"Текст, который отобразится в случае если не выбран ни 1 элемент"},getOptionLabel:{control:"object",description:"Функция которая позволяет выводить кастомные поля для описания опции, либо же кастомизировать реализацию самой опции"},items:{description:"Список элементов которые отображаются в выпадающем списке"}}},I={render:()=>{const e=[{id:1,name:"Aerospace"},{id:2,name:"Mechanical"},{id:3,name:"Civil"},{id:4,name:"Biomedical"},{id:5,name:"Nuclear"},{id:6,name:"Industrial"},{id:7,name:"Chemical"},{id:8,name:"Agricultural"},{id:9,name:"Electrical"}],[t,a]=c.useState();return g.jsx(M,{value:t,onChange:a,items:e,"aria-label":"select"})}},q={render:()=>{const e=[{id:1,label:"Aerospace"},{id:2,label:"Mechanical"},{id:3,label:"Civil"},{id:4,label:"Biomedical"}],[t,a]=c.useState(e[0]);return g.jsx(M,{value:t,onChange:a,items:e,"aria-label":"select",getOptionLabel:n=>n.label})}},K={render:()=>{const e=["1","2","3"],[t,a]=c.useState(e[0]);return g.jsx(M,{value:t,onChange:a,items:e,"aria-label":"select",getOptionLabel:n=>n})}};var Z,ee,te;I.parameters={...I.parameters,docs:{...(Z=I.parameters)==null?void 0:Z.docs,source:{originalSource:`{
  render: () => {
    const options: Array<Option> = [{
      id: 1,
      name: "Aerospace"
    }, {
      id: 2,
      name: "Mechanical"
    }, {
      id: 3,
      name: "Civil"
    }, {
      id: 4,
      name: "Biomedical"
    }, {
      id: 5,
      name: "Nuclear"
    }, {
      id: 6,
      name: "Industrial"
    }, {
      id: 7,
      name: "Chemical"
    }, {
      id: 8,
      name: "Agricultural"
    }, {
      id: 9,
      name: "Electrical"
    }];
    const [state, setState] = useState<Option>();
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} />;
  }
}`,...(te=(ee=I.parameters)==null?void 0:ee.docs)==null?void 0:te.source}}};var ae,ie,le;q.parameters={...q.parameters,docs:{...(ae=q.parameters)==null?void 0:ae.docs,source:{originalSource:`{
  render: () => {
    const options: Array<Option2> = [{
      id: 1,
      label: "Aerospace"
    }, {
      id: 2,
      label: "Mechanical"
    }, {
      id: 3,
      label: "Civil"
    }, {
      id: 4,
      label: "Biomedical"
    }];
    const [state, setState] = useState<Option2>(options[0]);
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} getOptionLabel={v => v.label} />;
  }
}`,...(le=(ie=q.parameters)==null?void 0:ie.docs)==null?void 0:le.source}}};var ne,oe,re;K.parameters={...K.parameters,docs:{...(ne=K.parameters)==null?void 0:ne.docs,source:{originalSource:`{
  render: () => {
    const options: Array<string> = ["1", "2", "3"];
    const [state, setState] = useState<string>(options[0]);
    return <Select value={state} onChange={setState} items={options} aria-label={"select"} getOptionLabel={v => v} />;
  }
}`,...(re=(oe=K.parameters)==null?void 0:oe.docs)==null?void 0:re.source}}};const Ze=["Default","WithCustomStructure","WithElementaryList"],$t=Object.freeze(Object.defineProperty({__proto__:null,Default:I,WithCustomStructure:q,WithElementaryList:K,__namedExportsOrder:Ze,default:Xe},Symbol.toStringTag,{value:"Module"}));export{I as D,$t as s};

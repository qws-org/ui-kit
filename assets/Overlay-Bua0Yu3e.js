import{r as m,R as y}from"./index-D4lIrffr.js";import{$ as A}from"./useControlledState-YrJM5BK_.js";import{c as _,b as B}from"./FocusScope-BrTNS4Jf.js";import{$ as K}from"./useFocusWithin-CIsqjyvK.js";import{n as M,e as V,l as q,m as N,y as G,z as D,x as U,q as Y}from"./useFocus-CQXXRA8U.js";import{$ as R}from"./getScrollParent-BRCFsFyw.js";import{d as j}from"./useFocusable-BOYJSphf.js";import{$ as z}from"./index-D5gmOSW9.js";function $e(e){let[t,n]=A(e.isOpen,e.defaultOpen||!1,e.onOpenChange);const o=m.useCallback(()=>{n(!0)},[n]),r=m.useCallback(()=>{n(!1)},[n]),l=m.useCallback(()=>{n(!t)},[n,t]);return{isOpen:t,setOpen:n,open:o,close:r,toggle:l}}function J({children:e}){let t=m.useMemo(()=>({register:()=>{}}),[]);return y.createElement(j.Provider,{value:t},e)}function X(e){let{ref:t,onInteractOutside:n,isDisabled:o,onInteractOutsideStart:r}=e,l=m.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),d=M(c=>{n&&I(c,t)&&(r&&r(c),l.current.isPointerDown=!0)}),s=M(c=>{n&&n(c)});m.useEffect(()=>{let c=l.current;if(o)return;const p=t.current,u=V(p);if(typeof PointerEvent!="undefined"){let g=h=>{c.isPointerDown&&I(h,t)&&s(h),c.isPointerDown=!1};return u.addEventListener("pointerdown",d,!0),u.addEventListener("click",g,!0),()=>{u.removeEventListener("pointerdown",d,!0),u.removeEventListener("click",g,!0)}}},[t,o,d,s])}function I(e,t){if(e.button>0)return!1;if(e.target){const n=e.target.ownerDocument;if(!n||!n.documentElement.contains(e.target)||e.target.closest("[data-react-aria-top-layer]"))return!1}return t.current?!e.composedPath().includes(t.current):!1}const F=new WeakMap;function pe(e){let{triggerRef:t,isOpen:n,onClose:o}=e;m.useEffect(()=>{if(!n||o===null)return;let r=l=>{let d=l.target;if(!t.current||d instanceof Node&&!d.contains(t.current)||l.target instanceof HTMLInputElement||l.target instanceof HTMLTextAreaElement)return;let s=o||F.get(t.current);s&&s()};return window.addEventListener("scroll",r,!0),()=>{window.removeEventListener("scroll",r,!0)}},[n,o,t])}const E=[];function be(e,t){let{onClose:n,shouldCloseOnBlur:o,isOpen:r,isDismissable:l=!1,isKeyboardDismissDisabled:d=!1,shouldCloseOnInteractOutside:s}=e;m.useEffect(()=>{if(r&&!E.includes(t))return E.push(t),()=>{let i=E.indexOf(t);i>=0&&E.splice(i,1)}},[r,t]);let c=()=>{E[E.length-1]===t&&n&&n()},p=i=>{(!s||s(i.target))&&E[E.length-1]===t&&(i.stopPropagation(),i.preventDefault())},u=i=>{(!s||s(i.target))&&(E[E.length-1]===t&&(i.stopPropagation(),i.preventDefault()),c())},g=i=>{i.key==="Escape"&&!d&&!i.nativeEvent.isComposing&&(i.stopPropagation(),i.preventDefault(),c())};X({ref:t,onInteractOutside:l&&r?u:void 0,onInteractOutsideStart:p});let{focusWithinProps:h}=K({isDisabled:!o,onBlurWithin:i=>{!i.relatedTarget||_(i.relatedTarget)||(!s||s(i.relatedTarget))&&(n==null||n())}}),x=i=>{i.target===i.currentTarget&&i.preventDefault()};return{overlayProps:{onKeyDown:g,...h},underlayProps:{onPointerDown:x}}}function me(e,t,n){let{type:o}=e,{isOpen:r}=t;m.useEffect(()=>{n&&n.current&&F.set(n.current,t.close)});let l;o==="menu"?l=!0:o==="listbox"&&(l="listbox");let d=q();return{triggerProps:{"aria-haspopup":l,"aria-expanded":r,"aria-controls":r?d:void 0,onPress:t.toggle},overlayProps:{id:d}}}const L=typeof document!="undefined"&&window.visualViewport,Q=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let O=0,S;function ve(e={}){let{isDisabled:t}=e;N(()=>{if(!t)return O++,O===1&&(G()?S=ee():S=Z()),()=>{O--,O===0&&S()}},[t])}function Z(){let e=window.innerWidth-document.documentElement.clientWidth;return D(e>0&&("scrollbarGutter"in document.documentElement.style?w(document.documentElement,"scrollbarGutter","stable"):w(document.documentElement,"paddingRight",`${e}px`)),w(document.documentElement,"overflow","hidden"))}function ee(){let e,t,n=p=>{e=R(p.target,!0),!(e===document.documentElement&&e===document.body)&&e instanceof HTMLElement&&window.getComputedStyle(e).overscrollBehavior==="auto"&&(t=w(e,"overscrollBehavior","contain"))},o=p=>{if(!e||e===document.documentElement||e===document.body){p.preventDefault();return}e.scrollHeight===e.clientHeight&&e.scrollWidth===e.clientWidth&&p.preventDefault()},r=()=>{t&&t()},l=p=>{let u=p.target;te(u)&&(s(),u.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{u.style.transform="",L&&(L.height<window.innerHeight?requestAnimationFrame(()=>{H(u)}):L.addEventListener("resize",()=>H(u),{once:!0}))}))},d=null,s=()=>{if(d)return;let p=()=>{window.scrollTo(0,0)},u=window.pageXOffset,g=window.pageYOffset;d=D(C(window,"scroll",p),w(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),w(document.documentElement,"overflow","hidden"),w(document.body,"marginTop",`-${g}px`),()=>{window.scrollTo(u,g)}),window.scrollTo(0,0)},c=D(C(document,"touchstart",n,{passive:!1,capture:!0}),C(document,"touchmove",o,{passive:!1,capture:!0}),C(document,"touchend",r,{passive:!1,capture:!0}),C(document,"focus",l,!0));return()=>{t==null||t(),d==null||d(),c()}}function w(e,t,n){let o=e.style[t];return e.style[t]=n,()=>{e.style[t]=o}}function C(e,t,n,o){return e.addEventListener(t,n,o),()=>{e.removeEventListener(t,n,o)}}function H(e){let t=document.scrollingElement||document.documentElement,n=e;for(;n&&n!==t;){let o=R(n);if(o!==document.documentElement&&o!==document.body&&o!==n){let r=o.getBoundingClientRect().top,l=n.getBoundingClientRect().top;l>r+n.clientHeight&&(o.scrollTop+=l-r)}n=o.parentElement}}function te(e){return e instanceof HTMLInputElement&&!Q.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}const ne=m.createContext({});function oe(){var e;return(e=m.useContext(ne))!==null&&e!==void 0?e:{}}const re=typeof HTMLElement!="undefined"&&"inert"in HTMLElement.prototype;let T=new WeakMap,b=[];function ge(e,t){let n=U(e==null?void 0:e[0]),o=t instanceof n.Element?{root:t}:t;var r;let l=(r=o==null?void 0:o.root)!==null&&r!==void 0?r:document.body,d=(o==null?void 0:o.shouldUseInert)&&re,s=new Set(e),c=new Set,p=a=>d&&a instanceof n.HTMLElement?a.inert:a.getAttribute("aria-hidden")==="true",u=(a,f)=>{d&&a instanceof n.HTMLElement?a.inert=f:f?a.setAttribute("aria-hidden","true"):a.removeAttribute("aria-hidden")},g=a=>{for(let v of a.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))s.add(v);let f=v=>{if(c.has(v)||s.has(v)||v.parentElement&&c.has(v.parentElement)&&v.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let k of s)if(v.contains(k))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},$=document.createTreeWalker(a,NodeFilter.SHOW_ELEMENT,{acceptNode:f}),P=f(a);if(P===NodeFilter.FILTER_ACCEPT&&h(a),P!==NodeFilter.FILTER_REJECT){let v=$.nextNode();for(;v!=null;)h(v),v=$.nextNode()}},h=a=>{var f;let $=(f=T.get(a))!==null&&f!==void 0?f:0;p(a)&&$===0||($===0&&u(a,!0),c.add(a),T.set(a,$+1))};b.length&&b[b.length-1].disconnect(),g(l);let x=new MutationObserver(a=>{for(let f of a)if(f.type==="childList"&&![...s,...c].some($=>$.contains(f.target)))for(let $ of f.addedNodes)($ instanceof HTMLElement||$ instanceof SVGElement)&&($.dataset.liveAnnouncer==="true"||$.dataset.reactAriaTopLayer==="true")?s.add($):$ instanceof Element&&g($)});x.observe(l,{childList:!0,subtree:!0});let i={visibleNodes:s,hiddenNodes:c,observe(){x.observe(l,{childList:!0,subtree:!0})},disconnect(){x.disconnect()}};return b.push(i),()=>{x.disconnect();for(let a of c){let f=T.get(a);f!=null&&(f===1?(u(a,!1),T.delete(a)):T.set(a,f-1))}i===b[b.length-1]?(b.pop(),b.length&&b[b.length-1].observe()):b.splice(b.indexOf(i),1)}}function Ee(e){let t=b[b.length-1];if(t&&!t.visibleNodes.has(e))return t.visibleNodes.add(e),()=>{t.visibleNodes.delete(e)}}const W=y.createContext(null);function he(e){let t=Y(),{portalContainer:n=t?null:document.body,isExiting:o}=e,[r,l]=m.useState(!1),d=m.useMemo(()=>({contain:r,setContain:l}),[r,l]),{getContainer:s}=oe();if(!e.portalContainer&&s&&(n=s()),!n)return null;let c=e.children;return e.disableFocusManagement||(c=y.createElement(B,{restoreFocus:!0,contain:(e.shouldContainFocus||r)&&!o},c)),c=y.createElement(W.Provider,{value:d},y.createElement(J,null,c)),z.createPortal(c,n)}function we(){let e=m.useContext(W),t=e==null?void 0:e.setContain;N(()=>{t==null||t(!0)},[t])}export{we as $,$e as a,me as b,be as c,ve as d,ge as e,he as f,pe as g,Ee as h};

import{r as p,R as h}from"./index-D4H_InIO.js";import{$ as M}from"./useControlledState-Dxxc-Ijj.js";import{c as R,b as F}from"./FocusScope-DUS13MDn.js";import{$ as W}from"./useFocusWithin-DR07ZYpu.js";import{p as O,e as H,l as k,m as L,y as A,z as T,o as _}from"./useFocus-CgYBR30T.js";import{$ as P}from"./getScrollParent-CcSDVQFU.js";import{d as B}from"./useFocusable-Gju1QyWb.js";import{$ as K}from"./index-BFEZrabH.js";function ie(e){let[t,n]=M(e.isOpen,e.defaultOpen||!1,e.onOpenChange);const o=p.useCallback(()=>{n(!0)},[n]),l=p.useCallback(()=>{n(!1)},[n]),c=p.useCallback(()=>{n(!t)},[n,t]);return{isOpen:t,setOpen:n,open:o,close:l,toggle:c}}function V({children:e}){let t=p.useMemo(()=>({register:()=>{}}),[]);return h.createElement(B.Provider,{value:t},e)}function q(e){let{ref:t,onInteractOutside:n,isDisabled:o,onInteractOutsideStart:l}=e,c=p.useRef({isPointerDown:!1,ignoreEmulatedMouseEvents:!1}),s=O(r=>{n&&S(r,t)&&(l&&l(r),c.current.isPointerDown=!0)}),u=O(r=>{n&&n(r)});p.useEffect(()=>{let r=c.current;if(o)return;const a=t.current,i=H(a);if(typeof PointerEvent!="undefined"){let b=f=>{r.isPointerDown&&S(f,t)&&u(f),r.isPointerDown=!1};return i.addEventListener("pointerdown",s,!0),i.addEventListener("click",b,!0),()=>{i.removeEventListener("pointerdown",s,!0),i.removeEventListener("click",b,!0)}}},[t,o,s,u])}function S(e,t){if(e.button>0)return!1;if(e.target){const n=e.target.ownerDocument;if(!n||!n.documentElement.contains(e.target)||e.target.closest("[data-react-aria-top-layer]"))return!1}return t.current?!e.composedPath().includes(t.current):!1}const N=new WeakMap;function ae(e){let{triggerRef:t,isOpen:n,onClose:o}=e;p.useEffect(()=>{if(!n||o===null)return;let l=c=>{let s=c.target;if(!t.current||s instanceof Node&&!s.contains(t.current)||c.target instanceof HTMLInputElement||c.target instanceof HTMLTextAreaElement)return;let u=o||N.get(t.current);u&&u()};return window.addEventListener("scroll",l,!0),()=>{window.removeEventListener("scroll",l,!0)}},[n,o,t])}const m=[];function le(e,t){let{onClose:n,shouldCloseOnBlur:o,isOpen:l,isDismissable:c=!1,isKeyboardDismissDisabled:s=!1,shouldCloseOnInteractOutside:u}=e;p.useEffect(()=>{if(l&&!m.includes(t))return m.push(t),()=>{let d=m.indexOf(t);d>=0&&m.splice(d,1)}},[l,t]);let r=()=>{m[m.length-1]===t&&n&&n()},a=d=>{(!u||u(d.target))&&m[m.length-1]===t&&(d.stopPropagation(),d.preventDefault())},i=d=>{(!u||u(d.target))&&(m[m.length-1]===t&&(d.stopPropagation(),d.preventDefault()),r())},b=d=>{d.key==="Escape"&&!s&&!d.nativeEvent.isComposing&&(d.stopPropagation(),d.preventDefault(),r())};q({ref:t,onInteractOutside:c&&l?i:void 0,onInteractOutsideStart:a});let{focusWithinProps:f}=W({isDisabled:!o,onBlurWithin:d=>{!d.relatedTarget||R(d.relatedTarget)||(!u||u(d.relatedTarget))&&(n==null||n())}}),x=d=>{d.target===d.currentTarget&&d.preventDefault()};return{overlayProps:{onKeyDown:b,...f},underlayProps:{onPointerDown:x}}}function ce(e,t,n){let{type:o}=e,{isOpen:l}=t;p.useEffect(()=>{n&&n.current&&N.set(n.current,t.close)});let c;o==="menu"?c=!0:o==="listbox"&&(c="listbox");let s=k();return{triggerProps:{"aria-haspopup":c,"aria-expanded":l,"aria-controls":l?s:void 0,onPress:t.toggle},overlayProps:{id:s}}}const C=typeof document!="undefined"&&window.visualViewport,Y=new Set(["checkbox","radio","range","color","file","image","button","submit","reset"]);let w=0,y;function se(e={}){let{isDisabled:t}=e;L(()=>{if(!t)return w++,w===1&&(A()?y=J():y=z()),()=>{w--,w===0&&y()}},[t])}function z(){return T(v(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),v(document.documentElement,"overflow","hidden"))}function J(){let e,t,n=a=>{e=P(a.target,!0),!(e===document.documentElement&&e===document.body)&&e instanceof HTMLElement&&window.getComputedStyle(e).overscrollBehavior==="auto"&&(t=v(e,"overscrollBehavior","contain"))},o=a=>{if(!e||e===document.documentElement||e===document.body){a.preventDefault();return}e.scrollHeight===e.clientHeight&&e.scrollWidth===e.clientWidth&&a.preventDefault()},l=()=>{t&&t()},c=a=>{let i=a.target;X(i)&&(u(),i.style.transform="translateY(-2000px)",requestAnimationFrame(()=>{i.style.transform="",C&&(C.height<window.innerHeight?requestAnimationFrame(()=>{D(i)}):C.addEventListener("resize",()=>D(i),{once:!0}))}))},s=null,u=()=>{if(s)return;let a=()=>{window.scrollTo(0,0)},i=window.pageXOffset,b=window.pageYOffset;s=T(g(window,"scroll",a),v(document.documentElement,"paddingRight",`${window.innerWidth-document.documentElement.clientWidth}px`),v(document.documentElement,"overflow","hidden"),v(document.body,"marginTop",`-${b}px`),()=>{window.scrollTo(i,b)}),window.scrollTo(0,0)},r=T(g(document,"touchstart",n,{passive:!1,capture:!0}),g(document,"touchmove",o,{passive:!1,capture:!0}),g(document,"touchend",l,{passive:!1,capture:!0}),g(document,"focus",c,!0));return()=>{t==null||t(),s==null||s(),r()}}function v(e,t,n){let o=e.style[t];return e.style[t]=n,()=>{e.style[t]=o}}function g(e,t,n,o){return e.addEventListener(t,n,o),()=>{e.removeEventListener(t,n,o)}}function D(e){let t=document.scrollingElement||document.documentElement,n=e;for(;n&&n!==t;){let o=P(n);if(o!==document.documentElement&&o!==document.body&&o!==n){let l=o.getBoundingClientRect().top,c=n.getBoundingClientRect().top;c>l+n.clientHeight&&(o.scrollTop+=c-l)}n=o.parentElement}}function X(e){return e instanceof HTMLInputElement&&!Y.has(e.type)||e instanceof HTMLTextAreaElement||e instanceof HTMLElement&&e.isContentEditable}const j=p.createContext({});function G(){var e;return(e=p.useContext(j))!==null&&e!==void 0?e:{}}let E=new WeakMap,$=[];function de(e,t=document.body){let n=new Set(e),o=new Set,l=r=>{for(let f of r.querySelectorAll("[data-live-announcer], [data-react-aria-top-layer]"))n.add(f);let a=f=>{if(n.has(f)||f.parentElement&&o.has(f.parentElement)&&f.parentElement.getAttribute("role")!=="row")return NodeFilter.FILTER_REJECT;for(let x of n)if(f.contains(x))return NodeFilter.FILTER_SKIP;return NodeFilter.FILTER_ACCEPT},i=document.createTreeWalker(r,NodeFilter.SHOW_ELEMENT,{acceptNode:a}),b=a(r);if(b===NodeFilter.FILTER_ACCEPT&&c(r),b!==NodeFilter.FILTER_REJECT){let f=i.nextNode();for(;f!=null;)c(f),f=i.nextNode()}},c=r=>{var a;let i=(a=E.get(r))!==null&&a!==void 0?a:0;r.getAttribute("aria-hidden")==="true"&&i===0||(i===0&&r.setAttribute("aria-hidden","true"),o.add(r),E.set(r,i+1))};$.length&&$[$.length-1].disconnect(),l(t);let s=new MutationObserver(r=>{for(let a of r)if(!(a.type!=="childList"||a.addedNodes.length===0)&&![...n,...o].some(i=>i.contains(a.target))){for(let i of a.removedNodes)i instanceof Element&&(n.delete(i),o.delete(i));for(let i of a.addedNodes)(i instanceof HTMLElement||i instanceof SVGElement)&&(i.dataset.liveAnnouncer==="true"||i.dataset.reactAriaTopLayer==="true")?n.add(i):i instanceof Element&&l(i)}});s.observe(t,{childList:!0,subtree:!0});let u={visibleNodes:n,hiddenNodes:o,observe(){s.observe(t,{childList:!0,subtree:!0})},disconnect(){s.disconnect()}};return $.push(u),()=>{s.disconnect();for(let r of o){let a=E.get(r);a!=null&&(a===1?(r.removeAttribute("aria-hidden"),E.delete(r)):E.set(r,a-1))}u===$[$.length-1]?($.pop(),$.length&&$[$.length-1].observe()):$.splice($.indexOf(u),1)}}function ue(e){let t=$[$.length-1];if(t&&!t.visibleNodes.has(e))return t.visibleNodes.add(e),()=>{t.visibleNodes.delete(e)}}const I=h.createContext(null);function fe(e){let t=_(),{portalContainer:n=t?null:document.body,isExiting:o}=e,[l,c]=p.useState(!1),s=p.useMemo(()=>({contain:l,setContain:c}),[l,c]),{getContainer:u}=G();if(!e.portalContainer&&u&&(n=u()),!n)return null;let r=e.children;return e.disableFocusManagement||(r=h.createElement(F,{restoreFocus:!0,contain:(e.shouldContainFocus||l)&&!o},r)),r=h.createElement(I.Provider,{value:s},h.createElement(V,null,r)),K.createPortal(r,n)}function $e(){let e=p.useContext(I),t=e==null?void 0:e.setContain;L(()=>{t==null||t(!0)},[t])}export{ie as $,ce as a,$e as b,le as c,se as d,de as e,fe as f,ae as g,ue as h};
